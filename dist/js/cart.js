"use strict";!function(){var n;if(getCookie("userphone")){var r=function(n,a,i){new Promise(function(i){$.ajax({type:"get",url:n,data:{sql:a},success:function(n){i(n)}})}).then(function(n){i&&i(n)})},t=function(){var a=[];return $(".no1 input").each(function(n,i){$(i).prop("checked")&&a.push(n)}),a},p=function(){var n=t(),i=0,a=0;n.forEach(function(n){i+=1*$(".car3-2 .nownum").eq(n).val(),a+=1*$(".car3-2 .total").eq(n).html()}),$("#total").html(i),$("#summary").html("￥"+a+".00")},i=function(n,i){var a=$(n).parent().find("input").val(),c=$(n).parent().parent().data("id"),e=$(n).parent().find("input").data("qty");"add"==i?a++:"cut"==i&&a--,e<a&&(a=e,alert("老板，没有更多了"),o=!1),o=!(a<1)||!(a=1),$(n).parent().find("input").val(a);var t=1*$(n).parent().prev().children().children().text(),l=t*a;console.log(t),$(n).parent().next().next().children().children().html(l);r("../api/other.php","UPDATE ordergoods SET buynum = "+a+",count = "+l+" WHERE id="+c),o&&p()};n=getCookie("userphone"),r("../api/select.php","SELECT * FROM cartlist where userid="+n,function(n){var i=JSON.parse(n).map(function(n){return"\n                    <li data-id='"+n.id+'\'>\n                        <div class="no1 fl">\n                            <input type="checkbox" name="" id="input1">\n                        </div>\n                        \n                        <div class="image fl">\n                            <img src="'+n.image+'" alt="">\n                        </div>\n                        <div class="title fl">\n                            <p>\n                                <a href="###" title="'+n.title+'">'+n.title+'</a>\n                            </p>\n                        </div>\n                        <div class="sizelist fl">\n                            <span><a href="###">'+n.size+'</a></span>\n                        </div>\n                        <div class="pricelist fl">\n                            <span class="price1">￥<span class="price2">'+n.price+'.00</span></span>\n                        </div>\n                        <div class="numlist fl">\n                            <a href="###" id="prev">减少\n\n                            </a>\n                            <input type="text" value="'+n.buynum+'" class="nownum" data-qty="'+n.qty+'">\n                            <a href="###" id="next"></a>\n                        </div>\n                        <div class="youhui fl">\n                            <span>-</span>\n                        </div>\n                        <div class="xiaoji fl">\n                            <span>￥\n                            <span class="total">'+n.count+'</span>\n                            .00</span>\n                        </div>\n                        <div class="cuozuo fl">\n                            <span><a href="###">删除</a></span>\n                        </div>\n                    </li>'});$(".car3-2").html(i)}),$(".car3-2").on("click",".cuozuo a",function(){var n=$(this).parent().parent().parent().data("id");console.log(n);var i="DELETE FROM cartlist WHERE id="+n;confirm("您确定要删除吗？")&&(r("../api/other.php",i),$(this).parent().parent().parent().remove())}),p(),$("#allclick2").click(function(){var n=$("#allclick2").prop("checked");$(".car3 input").prop("checked",n),p()}),$("#allclick1").click(function(){var n=$("#allclick1").prop("checked");$(".car-gift input").prop("checked",n),p()}),$(".car3-2").on("click",".no1 input",function(){$(".no1 input").size()==$(".no1 input:checked").size()?($("#allclick1").prop("checked",!0),$("#allclick2").prop("checked",!0)):($("#allclick1").prop("checked",!1),$("#allclick2").prop("checked",!1)),p()}),$("#del").click(function(){var n=t().reverse();console.log(n);var i=confirm("您确定要删除多行吗?"),a=$("#allclick2").is(":checked"),c="";if(i&&a){n.forEach(function(n){var i=$(".car3-2 li").eq(n).data("id");c+=i+",",$(".car3-2 li").eq(n).remove()});var e="DELETE FROM cartlist WHERE id in ("+c.slice(0,-1)+")";r("../api/other.php",e)}else alert("请勾全选");p()});var o=!0;$(".car3-2").on("click","#next",function(){i($(this),"add")}),$(".car3-2").on("click","#prev",function(){i($(this),"cut")})}}();